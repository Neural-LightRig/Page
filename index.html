<!DOCTYPE html>
<html>
<head>
  <script>
    const allowedHostname = "projects.zxhezexin.com";
    const allowedPath = "/neural-lightrig";
    const fileToCheck = "./LOCAL.FLAG";

    function fileExists(url, callback) {
        fetch(url, { method: "HEAD" })
            .then(response => {
                callback(response.ok);
            })
            .catch(() => {
                callback(false);
            });
    }

    fileExists(fileToCheck, fileExists => {
        if (!fileExists) {
            if (
                !window.top.location.hostname.includes(allowedHostname) ||
                !window.top.location.pathname.startsWith(allowedPath)
            ) {
                window.top.location.href = `https://${allowedHostname}${allowedPath}`;
            }
        } else {
            console.log("Redirecting disabled due to presence of the file:", fileToCheck);
        }
    });
  </script>

  <meta charset="utf-8">
  <meta name="description"
        content="Neural LightRig: Unlocking Accurate Object Normal and Material Estimation with Multi-Light Diffusion.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Neural LightRig: Unlocking Accurate Object Normal and Material Estimation with Multi-Light Diffusion</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script> -->

  <link rel="canonical" href="https://projects.zxhezexin.com/neural-lightrig">

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/external-links.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <!-- <h1 class="title is-1 publication-title">Neural LightRig: Unlocking Accurate Object Normal and Material Estimation with Multi-Light Diffusion</h1> -->
          <h1 class="title is-1 publication-title">
            Neural LightRig
          </h1>
          <h2 class="subtitle is-3">
            Unlocking Accurate Object Normal and Material Estimation <br> with Multi-Light Diffusion
          </h2>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://zxhezexin.com" class="external-link">Zexin He</a><sup>1*</sup>,</span>
            <span class="author-block">
              <a href="https://tengfei-wang.github.io" class="external-link">Tengfei Wang</a><sup>2*</sup>,</span>
            <span class="author-block">
              <a href="https://xhuangcv.github.io" class="external-link">Xin Huang</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://xingangpan.github.io" class="external-link">Xingang Pan</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://liuziwei7.github.io" class="external-link">Ziwei Liu</a><sup>3</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>The Chinese University of Hong Kong,</span>
            <span class="author-block"><sup>2</sup>Shanghai AI Lab,</span>
            <span class="author-block"><sup>3</sup>Nanyang Technological University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2412.09593"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2412.09593"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/ZexinHe/Neural-LightRig"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark disabled">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <!-- Teaser. -->
    <div class="hero-body">
      <video id="teaser-video" playsinline autoplay muted loop>
        <source src="./static/videos/teaser-video.mp4" type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <strong>TL;DR:</strong>&nbsp<span class="method-name">Neural LightRig</span> addresses the ill-posed nature of estimating surface properties <br>
        from a single image by <strong>generating multi-light images with a diffusion model</strong>, providing <br>
        auxiliary information for accurately predicting object normals and PBR materials.
      </h2>
    </div>
    <!--/ Teaser. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Recovering the geometry and materials of objects from a single image is challenging due to its under-constrained nature.
            In this paper, we present <span class="method-name">Neural LightRig</span>, a novel framework that boosts intrinsic estimation by leveraging auxiliary multi-lighting conditions from 2D diffusion priors.
          </p>
          <p>
            <strong>1)</strong> We first leverage illumination priors from large-scale diffusion models to build our <strong>Multi-Light Diffusion Model</strong> on a synthetic relighting dataset with dedicated designs.
            This diffusion model generates multiple consistent images, each illuminated by point light sources in different directions.
            <br>
            <strong>2)</strong> By using these varied lighting images to reduce estimation uncertainty, we train a <strong>Large G-Buffer Model</strong> with a U-Net backbone to accurately predict surface normals and materials.
          </p>
          <p>
            Extensive experiments validate that our approach significantly outperforms state-of-the-art methods, enabling accurate surface normal and PBR material estimation with vivid relighting effects.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!--/ Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <img src="./static/images/method_overview.jpg" alt="Method Overview" style="width: 100%">
          <p>
            <strong>Framework Overview.</strong>
            Multi-light diffusion generates multi-light images from an input image.
            These images with corresponding lighting orientations are then used to predict surface normals and PBR materials with a regression U-Net.
          </p>
        </div>
      </div>
    </div>
    <!--/ Method. -->

    <!-- Slider Controls -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <div class="slider-container is-flex is-align-items-center">
          <input id="light-slider" type="range" min="0" max="8" value="0" oninput="updateLight(this.value)" style="flex: 1;">
          <p style="margin-left: 15px;"><strong>Selected Light:</strong> <span id="slider-value">1</span></p>
        </div>
      </div>
    </div>

    <!-- Display Area -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-one-third">
        <img id="light-source" src="./static/images/slider/lighting-relation-0.png" alt="Light Source" style="height: 100%; width: 100%; object-fit: cover; object-position: center center; display: block; margin: 0 auto;">
        <p>Point Light Source</p>
      </div>
      <div class="column is-one-third">
        <img id="light-image" src="./static/images/slider/light-image-0.png" alt="Light Image" style="height: 100%; width: 100%; object-fit: cover; object-position: center center; display: block; margin: 0 auto;">
        <p>Light Image</p>
      </div>
    </div>

    <script>
      // Preload images
      const preloadImages = () => {
        const numImages = 9;
        const lightSourceImages = [];
        const lightImageImages = [];
        
        for (let i = 0; i < numImages; i++) {
          const lightSourceImg = new Image();
          lightSourceImg.src = `./static/images/slider/lighting-relation-${i}.png`;
          lightSourceImages.push(lightSourceImg);

          const lightImageImg = new Image();
          lightImageImg.src = `./static/images/slider/light-image-${i}.png`;
          lightImageImages.push(lightImageImg);
        }

        // Store preloaded images in a global object for easy access
        window.preloadedImages = {
          lightSource: lightSourceImages,
          lightImage: lightImageImages,
        };
      };

      // Update images based on slider value
      function updateLight(index) {
        const lightSourceImg = window.preloadedImages.lightSource[index];
        const lightImageImg = window.preloadedImages.lightImage[index];

        document.getElementById('light-source').src = lightSourceImg.src;
        document.getElementById('light-image').src = lightImageImg.src;

        document.getElementById('slider-value').innerText = parseInt(index) + 1;
      }

      // Preload images on page load
      document.addEventListener("DOMContentLoaded", preloadImages);
    </script>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Comparisons</h2>
        
        <!-- Compare Normal. -->
        <div class="content has-text-justified">
          <h3 class="title is-4">Surface Normal Estimation</h3>
          <img src="./static/images/normal_compare_main-HQ.jpeg" alt="Normal Comparison" style="width: 100%">
          <p>
            Qualitative comparison on surface normal estimation.
            Ground truth normals (G.T.) are provided for input images rendered from available 3D objects and are omitted for in-the-wild images.
          </p>
        </div>

        <!-- Compare PBR. -->
        <div class="content has-text-justified">
          <h3 class="title is-4">PBR Material Estimation</h3>
          <img src="./static/images/pbr_compare_main-HQ.jpeg" alt="PBR Comparison" style="width: 100%">
          <p>
            Qualitative comparison on PBR material estimation.
            Ground truth materials (G.T.) are provided for input images rendered from available 3D objects and are omitted for in-the-wild images.
          </p>
        </div>

        <!-- Compare Relighting. -->
        <div class="content has-text-justified">
          <h3 class="title is-4">Single-Image Relighting</h3>
          <img src="./static/images/relit_compare_main-HQ.jpeg" alt="Relighting Comparison" style="width: 100%">
          <p>
            Qualitative comparison on single-image relighting.
            The input image is relit with the estimated normal and material under different lighting conditions.
          </p>
          <div class="video-grid has-text-centered">
            <!-- RGB-X. -->
            <div class="video-item">
              <video id="row-1-rgbx" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/rgbx/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-rgbx" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/rgbx/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-rgbx" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/rgbx/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>RGB-X</p>
            </div>
          
            <!-- DiLightNet. -->
            <div class="video-item">
              <video id="row-1-dilightnet" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/dilightnet/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-dilightnet" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/dilightnet/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-dilightnet" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/dilightnet/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>DiLightNet</p>
            </div>

            <!-- IC-Light. -->
            <div class="video-item">
              <video id="row-1-iclight" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/iclight/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-iclight" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/iclight/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-iclight" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/iclight/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>IC-Light</p>
            </div>

            <!-- Yi. et al. -->
            <div class="video-item">
              <video id="row-1-yietal" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/yietal/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-yietal" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/yietal/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-yietal" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/yietal/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>Yi. et al</p>
            </div>
          
            <!-- IntrinsicAnything. -->
            <div class="video-item">
              <video id="row-1-ia" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ia/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-ia" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ia/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-ia" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ia/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>IntrinsicAnything</p>
            </div>
          
            <!-- Ours. -->
            <div class="video-item">
              <video id="row-1-ours" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ours/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-ours" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ours/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-ours" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/ours/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>Ours</p>
            </div>
          
            <!-- G.T. -->
            <div class="video-item">
              <video id="row-1-gt" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/gt/brownstudio_0.mp4" type="video/mp4">
              </video>
              <video id="row-2-gt" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/gt/sunrise_0.mp4" type="video/mp4">
              </video>
              <video id="row-3-gt" playsinline autoplay muted loop>
                <source src="./static/videos/relit_videos/gt/courtyard_0.mp4" type="video/mp4">
              </video>
              <p>G.T.</p>
            </div>

            <script>
              document.addEventListener("DOMContentLoaded", () => {
                const rows = [1, 2, 3]; // Adjust based on the number of rows
                const methods = ["rgbx", "dilightnet", "iclight", "yietal", "ia", "ours", "gt"]; // Methods corresponding to columns
            
                rows.forEach((rowNumber) => {
                  const videos = methods.map(
                    (method) => document.getElementById(`row-${rowNumber}-${method}`)
                  );
            
                  let readyVideos = 0;
            
                  const onVideoReady = () => {
                    readyVideos++;
                    if (readyVideos === videos.length) {
                      // Align all videos in the row
                      const currentTime = videos[0].currentTime;
                      videos.forEach((video) => {
                        video.currentTime = currentTime;
                      });
            
                      // Ensure all videos play simultaneously
                      videos.forEach((video) => {
                        video.play();
                      });
            
                      // Sync during playback
                      const syncInterval = setInterval(() => {
                        const referenceTime = videos[0].currentTime;
                        videos.forEach((video) => {
                          if (Math.abs(video.currentTime - referenceTime) > 0.1) {
                            video.currentTime = referenceTime;
                          }
                        });
                      }, 100);
            
                      // Clear sync on pause
                      videos.forEach((video) => {
                        video.addEventListener("pause", () => {
                          clearInterval(syncInterval);
                        });
                      });
                    }
                  };
            
                  // Attach event listeners to each video
                  videos.forEach((video) => {
                    video.addEventListener("loadeddata", onVideoReady);
                  });
                });
              });
            </script>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Demo Video</h2>
        <video id="demo-video" controls playsinline preload="auto" height="100%">
          <source src="./static/videos/video-v2.0-1080p.mp4" type="video/mp4">
        </video>
      </div>
    </div>      
  </div>
</section>

<section class="section" id="BibTeX"></section>
  <div class="container is-max-desktop content">
    <h2 class="title is-3">BibTeX</h2>
    <pre class="citation-block"><code>@misc{neural_lightrig,
    title={Neural LightRig: Unlocking Accurate Object Normal and Material Estimation with Multi-Light Diffusion}, 
    author={Zexin He and Tengfei Wang and Xin Huang and Xingang Pan and Ziwei Liu},
    year={2024},
    eprint={2412.09593},
    archivePrefix={arXiv},
    primaryClass={cs.CV},
    url={https://arxiv.org/abs/2412.09593},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link external-link" href="https://arxiv.org/pdf/2412.09593" disabled>
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link external-link" href="https://arxiv.org/abs/2412.09593" disabled>
        <i class="ai ai-arxiv"></i>
      </a>
      <!-- <a class="icon-link external-link" href="" disabled>
        <i class="fab fa-youtube"></i>
      </a> -->
      <a class="icon-link external-link" href="https://github.com/ZexinHe/Neural-LightRig" disabled>
        <i class="fab fa-github"></i>
      </a>
      <a class="icon-link external-link disabled" href="" disabled>
        <i class="far fa-images"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
            <br>
            Page templated from <a href="https://nerfies.github.io/" class="external-link">Nerfies</a>. We thank the authors for sharing the templates.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
